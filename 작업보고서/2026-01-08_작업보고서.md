# 작업보고서 - 2026년 1월 8일

## 프로젝트: 삼성폰 IP Webcam 자동차 번호판 인식 시스템

---

## 작업 기록

### 22:15 - 작업 재개
- **상황**: 이전 세션에서 EasyOCR 한글 인식 모델 다운로드 중 크래시 발생
- **현재 상태**:
  - IP Webcam 앱 설치 및 동작 확인 완료
  - 기본 가이드 문서 (`ip_webcam_license_plate_guide.md`) 작성 완료
  - 번호판 인식 코드 (`license_plate_recognition.py`) 작성 완료
  - EasyOCR 한글 모델 다운로드 미완료

### 22:15 - 작업보고서 폴더 및 파일 생성
- 작업보고서 폴더 생성: `/home/uttec/uttec/lisencePlate/작업보고서/`
- 오늘 날짜 작업보고서 파일 생성

### 22:16 - 진행 예정 작업
1. 기존 설치 매뉴얼 검토 및 보완
2. EasyOCR 및 한글 모델 설치 상태 확인
3. 한글 인식 모델 다운로드 재시도
4. 번호판 인식 테스트

### 22:45 - EasyOCR 메모리 문제 발견 및 Tesseract로 전환
- **문제**: 라즈베리파이 메모리(906MB)로 EasyOCR + PyTorch 실행 불가 (OOM Kill)
- **해결**: Tesseract OCR로 전환 결정 (더 가볍고 안정적)

### 22:50 - Tesseract OCR 설치 완료
- Python 가상환경 생성: `venv/`
- Tesseract OCR 5.5.0 설치 (`sudo apt-get install tesseract-ocr tesseract-ocr-kor`)
- 한글 언어팩(kor) 설치 완료
- pytesseract 파이썬 패키지 설치

### 23:00 - 코드 수정 완료
- `license_plate_recognition.py`를 EasyOCR에서 Tesseract OCR로 전환
- 라즈베리파이 성능 최적화:
  - 이미지 크기 조정 기능 추가 (1920x1080 → 800x450)
  - 전체 이미지 OCR 대신 후보 영역만 처리
  - 후보 영역 없을 시 중앙 50% 영역만 OCR

### 23:10 - 테스트 완료
- IP Webcam 연결 테스트: 성공 (192.168.0.33:8080)
- 이미지 가져오기: 성공 (1080x1920 이미지)
- Tesseract OCR 초기화: 성공
- 번호판 인식 파이프라인: 정상 작동 (번호판 샘플 필요)

### 23:13 - 번호판 인식 테스트 성공
- 번호판 패턴 인식 테스트: **61너7068** 인식 성공
- 실제 차량 번호판(201누2734) 수동 테스트 성공

### 23:20 - 기능 개선
- **사용자 요청**: 번호판 패턴뿐만 아니라 일반 한글/숫자 텍스트도 읽기
- **변경 사항**:
  - 번호판 패턴 매칭 + 일반 텍스트 인식 모드 추가
  - 자동 촬영 → 엔터 키 입력 시 촬영 방식으로 변경
  - 결과를 `results.txt` 파일에 UTF-8로 저장 (터미널 인코딩 문제 해결)

### 23:40 - 터미널 인코딩 문제 해결
- 라즈베리파이 터미널에서 한글 출력 시 UnicodeEncodeError 발생
- 해결: 모든 메시지를 영어로 변경, 한글은 유니코드 이스케이프로 출력
- 결과는 `results.txt`에서 한글로 확인 가능

### 23:55 - OCR 설정 최적화
- **문제**: PSM 7 (단일 라인) 모드에서 인식 실패
- **해결**: PSM 4 (다양한 크기의 단일 열) 모드로 변경
- ROI 영역 조정: 화면 중앙 30-60% (높이), 30-70% (너비)

### 00:02 - 한글 텍스트 인식 테스트 성공
- 테스트 텍스트: "홍광선", "잘살자"
- 결과: "홍광선" 정확히 인식, "잘살자"는 "조지"로 오인식
- Tesseract 한글 인식률 한계 확인

---

## 시스템 환경
- **하드웨어**: Raspberry Pi (Linux 6.12.47+rpt-rpi-v8)
- **OS**: Raspberry Pi OS
- **Python**: 3.13
- **OCR 엔진**: Tesseract OCR 5.5.0 (한글 지원)
- **스마트폰**: 삼성폰 + IP Webcam 앱

---

## 파일 구조
```
/home/uttec/uttec/licensePlate/
├── camera_guide.md                    # 라즈베리파이 카메라 가이드
├── scrcpy_guide.md                    # scrcpy 가이드
├── ip_webcam_license_plate_guide.md   # IP Webcam 번호판 인식 설치 가이드
├── license_plate_recognition.py       # 메인 번호판 인식 프로그램 (Tesseract 기반)
├── test_connection.py                 # 연결 테스트 스크립트
├── test_snapshot.jpg                  # 테스트용 스냅샷 이미지
├── venv/                              # Python 가상환경
└── 작업보고서/
    └── 2026-01-08_작업보고서.md        # 오늘 작업보고서
```

---

## 사용 방법
```bash
# 가상환경 활성화 후 실행
source venv/bin/activate
python license_plate_recognition.py
```

---

## 메모
- PHONE_IP: 192.168.0.33 (현재 설정값)
- IP Webcam 포트: 8080
- 라즈베리파이 메모리: 906MB (EasyOCR 사용 불가 → Tesseract 사용)

---

## 다음 작업 (TODO)
1. Tesseract 한글 인식률 개선 (더 나은 학습 데이터 또는 전처리 방법)
2. 다양한 조명/각도에서의 인식 테스트
3. 실시간 스트리밍 모드 추가 (선택적)
4. 인식 결과 로깅 및 통계 기능
